<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <title>Aw CRUD</title>
        <link rel="stylesheet" type="text/css" th:href="@{/css/main.css}">
        <link rel="stylesheet" type="text/css" th:href="@{/css/wheel.css}">
    </head>
    <body>
        <div id="content">
            <div id="header" class="container">
                <h1>Aw CRUD...</h1>
                <form method="post" th:action="@{/auth/logout}" id="logout-form">
                    <button type="submit">Logout</button>
                </form>
            </div>

            <div th:if="${currentUser}" id="user-display" th:insert="~{fragments/userDisplay :: user-display(${currentUser})}"></div>

            <div th:if="${wheelPage != null and wheelUserCount != null and wheelWinner != null}" id="user-wheel" th:insert="~{ fragments/userWheel :: user-wheel( ${wheelPage}, ${wheelUserCount}, ${wheelWinner} ) }"></div>

            <form th:if="${userPage != null}" method="post" th:action="@{/crud/spinWheel}" class="container" id="spin-wheel-form">
                <button type="submit">Spin</button>
            </form>
            
            <form th:if="${userPage != null}" method="post" th:action="@{/crud/requestPage}" class="container" id="request-page-form">
                <label for="pageNumber">Page: <input type="number" name="pageNumber" id="pageNumber" th:value="${userPage.number}" required></label>
                <label for="pageSize">Size: <input type="number" name="pageSize" id="pageSize" th:value="${userPage.size}" required></label>
                <button type="submit">Request Page</button>
            </form>

            <div th:if="${userPage != null}" id="user-table" th:insert="~{fragments/userTable :: user-table(${userPage})}"></div>

            <form method="post" th:action="@{/crud/create}" class="container">
                <label for="username">Username: <input type="text" name="username" id="username" required></label>
                <label for="password">Password: <input type="text" name="password" id="password" required></label>
                <button type="submit">Create</button>
                <div th:switch="${param.registerUser != null ? param.registerUser[0] : ''}">
                    <div th:case="'true'" style="color: rgb(0, 157, 255);">User registration succeeded for: <span th:text="${param.registerUserUsername}"></span></div>
                    <div th:case="'false'" style="color: rgb(255, 0, 0);">User registration failed for: <span th:text="${param.registerUserUsername}"></span></div>
                </div>
            </form>

            <div class="container" style="display: flex; flex-direction: column; gap: 10px;">
                <form method="post" th:action="@{/crud/create-test-users}" >
                    <button type="submit">DEBUG: Create Test Users</button>
                </form>

                <form method="post" th:action="@{/crud/delete-test-users}">
                    <button type="submit" onclick="return confirm('Are you sure you want to delete all test users?')">DEBUG: Delete Test Users</button>
                </form>

                <form method="post" th:action="@{/crud/delete-all-users}">
                    <button type="submit" onclick="return confirm('Are you sure you want to delete ALL users? This cannot be undone!')">DEBUG: Delete ALL Users</button>
                </form>

            </div>
        </div>
    </body>
</html>